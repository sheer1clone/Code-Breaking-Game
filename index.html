<!DOCTYPE html>
<html lang="en">

<head>

    <!-- Character encoding -->
    <meta charset="UTF-8">
    
    <!-- Viewport settings -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Favicon -->
    <link rel="icon" href="data:,">

    <!-- Page title -->
    <title> Code Breaking Game </title>
    
    <style>

        /* ===== ANIMATIONS ===== */

        /* Explosion animation - particles expanding outward */
        @keyframes explode {
            0% { opacity: 0; transform: scale(0.1); }
            50% { opacity: 1; }
            100% { opacity: 0; transform: scale(3); }
        }

        /* Fade-in effect for elements */
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        /* Pulsing effect for buttons and interactive elements */
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }





        /* ===== BASE STYLES ===== */

        body {
            /* Layout & Box Model */
            display: flex;
            flex-direction: column;
            margin: 0 auto;
            max-width: 800px;
            min-height: 95vh;
            padding: 20px;
            padding-bottom: 40px;
            
            /* Typography */
            font-family: Arial, sans-serif;
            
            /* Visual */
            background-color: #f0f0f0;
        }
    
        h1 {
            /* Layout & Box Model */
            margin-top: 35px;
        }
    
        input {
            /* Layout & Box Model */
            margin: 10px 0;
            padding: 8px;
            width: 200px;
        }
    
        button {
            /* Layout & Box Model */
            border: none;
            border-radius: 4px;
            margin-right: 5px;
            padding: 8px 16px;
            
            /* Typography */
            color: white;
            
            /* Visual */
            background-color: #4CAF50;
            cursor: pointer;
        }
    
        button:hover {
            /* Visual */
            background-color: #45a049;
        }
    




        /* ===== GAME CONTENT ===== */

        .game-content {
            /* Layout & Box Model */
            display: none;
            min-height: 100vh;
            padding-top: 20px;
            box-sizing: border-box;
        }
    




        /* ===== START MENU ===== */

        .start-menu {
            /* Layout & Box Model */
            align-items: center;
            display: flex;
            height: 100%;
            justify-content: center;
            width: 100%;
            
            /* Positioning */
            left: 0;
            position: fixed;
            top: 0;
            z-index: 1000;
            
            /* Visual */
            background-color: #f0f0f0;
            transition: opacity 0.5s ease;
        }
    
        .start-content {
            /* Layout & Box Model */
            max-width: 600px;
            padding: 40px;
            text-align: center;
            
            /* Visual */
            animation: fadeIn 1s ease;
        }
    
        .start-content h1 {
            /* Typography */
            font-size: 2.5em;
            margin-bottom: 20px;
        }
    
        .start-content p {
            /* Typography */
            font-size: 1.2em;
            margin-bottom: 30px;
        }
    
        .start-content button {
            /* Layout & Box Model */
            font-size: 1.8em;
            padding: 15px 40px;
            
            /* Visual */
            animation: pulse 1.5s infinite alternate;
            transition: transform 0.2s, background-color 0.3s;
        }
    
        .start-content button:hover {
            /* Visual */
            background-color: #45a049;
            transform: scale(1.05);
        }





        /* ===== END GAME SCREEN ===== */

        .end-content {
            /* Layout & Box Model */
            max-width: 600px;
            padding: 40px;
            text-align: center;
            
            /* Visual */
            animation: fadeIn 3s ease;
        }

        .end-content h1 {
            /* Typography */
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .trophy {
            /* Typography */
            font-size: 5em;
            margin: 20px 0;
            
            /* Visual */
            animation: pulse 1.5s infinite alternate;
        }

        .end-content p {
            /* Typography */
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .end-buttons {
            /* Layout & Box Model */
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        .end-buttons button {
            /* Layout & Box Model */
            padding: 5px 12px;
            width: 80%;
            max-width: 400px;
            margin: 0 auto;

            /* Typography */
            font-size: 1.5em;
            
            /* Visual */
            transition: transform 0.2s, background-color 0.3s;
        }

        .end-buttons button:hover {
            /* Visual */
            transform: scale(1.05);
        }

        .credits {
            /* Layout & Box Model */
            margin-top: 40px;
            display: none;
            
            /* Visual */
            animation: fadeIn 0.5s ease;
        }

        .credit-role {
            /* Typography */
            font-size: 0.9em;
            margin-top: 20px;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .credit-name {
            /* Typography */
            font-size: 1.1em;
            margin-top: 0;
        }

        .credit-date {
            /* Typography */
            margin-top: 20px;
            font-size: 1em;
        }

        .medal-img {
            width: 150px;
            height: auto;
            animation: inherit;
        }

        .credit-name a {
            color: #4CAF50;
            text-decoration: none;
        }

        .credit-name a:hover {
            text-decoration: underline;
        }

        body.dark-mode .credit-name a {
            color: #8bc34a;
        }

        .credit-date {
            /* Typography */
            margin-top: 20px;
            font-size: 1em;
        }
    




        /* ===== PUZZLES ===== */

        .puzzle-container {
            /* Layout & Box Model */
            flex-grow: 1;
            margin-bottom: 20px;
            padding: 20px;
            
            /* Visual */
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    
        .puzzle {
            /* Layout & Box Model */
            display: none;
            margin-bottom: 20px;
        }
    
        .puzzle.active {
            /* Layout & Box Model */
            display: block;
        }
    
        .progress {
            /* Layout & Box Model */
            margin-bottom: 20px;
        }
    
        .navigation-buttons {
            /* Layout & Box Model */
            margin-top: 20px;
            padding: 10px;
            
            /* Typography */
            text-align: center;
        }
    
        .solved-indicator {
            /* Layout & Box Model */
            display: none;
            margin-left: 10px;
            padding: 3px 8px;
            
            /* Typography */
            color: white;
            font-size: 0.8em;
            font-weight: bold;
            vertical-align: middle;
            
            /* Visual */
            background-color: #4CAF50;
            border-radius: 4px;
        }
    




        /* ===== HINTS ===== */

        .hint {
            /* Layout & Box Model */
            display: none;
            margin-top: 10px;
            
            /* Typography */
            color: #666;
            font-style: italic;
        }
    
        .hint-block {
            /* Layout & Box Model */
            border-radius: 4px;
            display: block;
            margin-top: 10px;
            padding: 8px 16px;
            width: fit-content;
            
            /* Typography */
            color: white;
            font-weight: bold;
            
            /* Visual */
            background-color: #4CAF50;
            cursor: pointer;
        }
    
        .hint-block:hover {
            /* Visual */
            background-color: #45a049;
        }
    




        /* ===== MENU ===== */

        .menu {
            /* Layout & Box Model */
            padding: 20px;
            
            /* Positioning */
            left: -250px;
            position: fixed;
            top: 60px;
            z-index: 102;
            
            /* Typography */
            text-align: center;
            
            /* Visual */
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: left 0.5s ease;
        }
    
        .menu button {
            /* Layout & Box Model */
            display: block;
            margin: 10px 0;
            width: 100%;
        }
    
        .menu-button {
            /* Layout & Box Model */
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            
            /* Positioning */
            left: 10px;
            position: fixed;
            top: 10px;
            z-index: 101;
            
            /* Typography */
            color: white;
            
            /* Visual */
            background-color: #4CAF50;
            cursor: pointer;
        }
    
        .menu-separator {
            /* Layout & Box Model */
            border: 0;
            height: 1px;
            margin: 15px 0;
            
            /* Visual */
            background-color: #ccc;
        }
    
        .menu.show {
            /* Positioning */
            left: 10px;
        }

        .menu-button:active, .menu-button:focus {
            /* Visual */
            background-color: rgba(76, 175, 80, 0.9);
            outline: none;
        }

    




        /* ===== MESSAGES ===== */

        .success-message, .error-message {
            /* Layout & Box Model */
            display: none;
            padding: 20px;
            
            /* Positioning */
            left: 50%;
            position: fixed;
            top: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            
            /* Typography */
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            
            /* Visual */
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    
        .success-message {
            /* Visual */
            background-color: #4CAF50;
        }
    
        .error-message {
            /* Visual */
            background-color: #f44336;
        }
    
        .success {
            /* Typography */
            color: #4CAF50;
            font-weight: bold;
        }
    




        /* ===== FIREWORKS ===== */

        .fireworks-container {
            /* Layout & Box Model */
            height: 100%;
            width: 100%;
            
            /* Positioning */
            left: 0;
            position: fixed;
            top: 0;
            z-index: 99;
            
            /* Visual */
            pointer-events: none;
        }
    
        .firework {
            /* Layout & Box Model */
            border-radius: 50%;
            height: 5px;
            width: 5px;
            
            /* Positioning */
            position: absolute;
            
            /* Visual */
            animation: explode 1s ease-out forwards;
            box-shadow: 0 0 10px 5px rgba(255, 255, 255, 0.8);
            opacity: 0;
        }
    




        /* ===== CHEAT SHEETS (COMMON) ===== */

        .cheat-sheet {
            /* Layout & Box Model */
            display: none;
            height: 100%;
            width: 100%;
            
            /* Positioning */
            left: 0;
            position: fixed;
            top: 0;
            z-index: 200;
            
            /* Visual */
            background-color: rgba(0,0,0,0.7);
        }
    
        .cheat-sheet-content {
            /* Layout & Box Model */
            max-height: 80vh;
            max-width: fit-content;
            min-width: 300px;
            overflow: visible;
            overflow-y: auto;
            padding: 20px;
            text-align: center;
            width: auto;
            
            /* Positioning */
            left: 50%;
            position: relative;
            top: 50%;
            transform: translate(-50%, -50%);
            
            /* Visual */
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    
        .close-button {
            /* Positioning */
            position: absolute;
            right: 15px;
            top: 10px;
            
            /* Typography */
            font-size: 24px;
            font-weight: bold;
            
            /* Visual */
            cursor: pointer;
        }
    




        /* ===== MORSE CODE CHEAT SHEET ===== */

        .morse-grid {
            /* Layout & Box Model */
            display: grid;
            gap: 6px;
            grid-auto-flow: column;
            grid-template-rows: repeat(9, auto);
            justify-content: center;
            margin: 20px auto 0;
            width: fit-content;
        }
    
        .morse-item {
            /* Layout & Box Model */
            align-items: center;
            display: flex;
            justify-content: center;
            padding: 4px 8px;
            width: max-content;
            
            /* Typography */
            font-size: 14px;
            white-space: nowrap;
            
            /* Visual */
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    
        .morse-item strong {
            /* Layout & Box Model */
            display: inline-block;
            text-align: center;
            width: 15px;
        }
    
        .morse-arrow {
            /* Layout & Box Model */
            display: inline-block;
            margin: 0 6px;
            width: 10px;
            
            /* Typography */
            text-align: center;
            
            /* Visual */
            color: #666;
        }
    
        .morse-code {
            /* Layout & Box Model */
            min-width: 45px;
            
            /* Typography */
            font-family: monospace;
            text-align: center;
        }
    




        /* ===== BINARY CODE CHEAT SHEET ===== */

        .binary-grid {
            /* Layout & Box Model */
            display: grid;
            gap: 6px;
            grid-auto-flow: column;
            grid-template-rows: repeat(9, auto);
            justify-content: center;
            margin: 20px auto 0;
            width: fit-content;
        }
    
        .binary-item {
            /* Layout & Box Model */
            align-items: center;
            display: flex;
            justify-content: center;
            padding: 4px 8px;
            width: max-content;
            
            /* Typography */
            font-size: 14px;
            white-space: nowrap;
            
            /* Visual */
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    
        .binary-item strong {
            /* Layout & Box Model */
            display: inline-block;
            text-align: center;
            width: 15px;
        }
    
        .binary-arrow {
            /* Layout & Box Model */
            display: inline-block;
            margin: 0 6px;
            width: 10px;
            
            /* Typography */
            text-align: center;
            
            /* Visual */
            color: #666;
        }
    
        .binary-code {
            /* Layout & Box Model */
            min-width: 80px;
            
            /* Typography */
            font-family: monospace;
            text-align: center;
        }
    




        /* ===== ALPHABET CHEAT SHEET ===== */

        .alphabet-grid {
            /* Layout & Box Model */
            display: grid;
            gap: 6px;
            grid-auto-flow: column;
            grid-template-rows: repeat(9, auto);
            justify-content: center;
            margin: 20px auto 0;
            width: fit-content;
        }
    
        .alphabet-item {
            /* Layout & Box Model */
            align-items: center;
            display: flex;
            justify-content: center;
            padding: 4px 8px;
            width: max-content;
            
            /* Typography */
            font-size: 14px;
            white-space: nowrap;
            
            /* Visual */
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    
        .alphabet-item strong {
            /* Layout & Box Model */
            display: inline-block;
            text-align: center;
            width: 15px;
        }
    
        .alphabet-arrow {
            /* Layout & Box Model */
            display: inline-block;
            margin: 0 6px;
            width: 10px;
            
            /* Typography */
            text-align: center;
            
            /* Visual */
            color: #666;
        }
    
        .alphabet-code {
            /* Layout & Box Model */
            min-width: 20px;
            
            /* Typography */
            font-family: monospace;
            text-align: center;
        }



        
        /* ===== INFO TOOLTIPS ===== */

        .info-container {
            /* Layout & Box Model */
            margin: 0;
            
            /* Positioning */
            position: absolute;
            top: 10px;
            left: 15px;
            z-index: 300;
        }

        .info-button {
            /* Layout & Box Model */
            border: none;
            padding: 5px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            
            /* Typography */
            font-size: 20px;
            font-weight: bold;
            
            /* Visual */
            background: none; 
            color: #333;
            cursor: pointer;
            box-shadow: none;
        }

        .standalone-tooltip {
            /* Layout & Box Model */
            width: 280px;
            padding: 12px 15px;
            
            /* Positioning */
            position: fixed;
            z-index: 2000;
            
            /* Typography */
            font-size: 14px;
            line-height: 1.4;
            text-align: left;
            
            /* Visual */
            background-color: #f8f8f8;
            border-radius: 4px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.5);
            display: none;
        }
        
        .standalone-tooltip:after {
            /* Positioning */
            position: absolute;
            bottom: -8px;
            left: 12px;
            
            /* Visual */
            content: '';
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #f8f8f8;
        }

        .standalone-tooltip.show {
            /* Visual */
            display: block;
        }

        .standalone-tooltip h2 {
            /* Typography */
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .info-button:hover {
            /* Visual */
            background: transparent;
            color: #666;
        }




        /* ===== CONFIRMATION DIALOG ===== */

        .confirmation-content {
            /* Layout & Box Model */
            max-width: 350px;
            min-width: 250px;
            text-align: center;
            padding-top: 10px;
            padding-bottom: 40px;
        }

        .confirmation-content h2 {
            /* Typography */
            margin-top: 5px;
            margin-bottom: 15px;
        }

        .confirmation-content p {
            /* Typography */
            margin-bottom: 50px;
        }

        .confirmation-buttons {
            /* Layout & Box Model */
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
        }

        .confirm-button {
            /* Visual */
            background-color: #d32f2f;
        }

        .confirm-button:hover {
            /* Visual */
            background-color: #b71c1c;
        }

        .cancel-button {
            /* Visual */
            background-color: #757575;
        }

        .cancel-button:hover {
            /* Visual */
            background-color: #616161;
        }

        #confirmationDialog {
            z-index: 2000;
        }




        /* ===== DARK MODE ===== */

        body.dark-mode {
            /* Visual */
            background-color: #222;
            color: #f0f0f0;
        }
    
        body.dark-mode .start-menu {
            /* Visual */
            background-color: #222;
        }
    
        body.dark-mode .puzzle-container {
            /* Visual */
            background-color: #333;
            box-shadow: 0 2px 4px rgba(255,255,255,0.1);
        }
    
        body.dark-mode .menu {
            /* Visual */
            background-color: #333;
            color: #fff;
        }
    
        body.dark-mode .hint {
            /* Typography */
            color: #fff;
        }
    
        body.dark-mode .cheat-sheet-content {
            /* Visual */
            background-color: #333;
            color: #fff;
        }
    
        body.dark-mode .morse-arrow,
        body.dark-mode .binary-arrow, 
        body.dark-mode .alphabet-arrow {
            /* Visual */
            color: #fff;
        }
    
        body.dark-mode .morse-item, 
        body.dark-mode .binary-item,
        body.dark-mode .alphabet-item {
            /* Visual */
            border: 1px solid #555;
        }
    
        body.dark-mode .success-message {
            /* Visual */
            background-color: #45a049;
        }
    
        body.dark-mode .error-message {
            /* Visual */
            background-color: #d32f2f;
            box-shadow: 0 4px 8px rgba(255,255,255,0.1);
        }
    
        body.dark-mode input {
            /* Visual */
            background-color: #444;
            border: 1px solid #666;
            color: #fff;
        }
        
        body.dark-mode .info-button {
            /* Visual */
            color: #ccc;
        }

        body.dark-mode .standalone-tooltip {
            /* Visual */
            background-color: #444;
            color: #fff;
            box-shadow: 0 2px 15px rgba(255,255,255,0.1);
        }

        body.dark-mode .standalone-tooltip:after {
            /* Visual */
            border-top-color: #444;
        }

        body.dark-mode .menu-separator {
            /* Visual */
            background-color: #555;
        }

        body.dark-mode .info-button:hover {
            /* Visual */
            color: #fff;
        }

        body.dark-mode .menu-button:hover {
            /* Visual */
            background-color: #45a049;
        }





        /* ===== RESPONSIVE DESIGN ===== */

        @media screen and (min-height: 700px) {
            /* For taller screens like desktops/PCs */
            .puzzle-container {
                /* Layout & Box Model */
                min-height: 60vh;
                padding: 30px;
                margin-bottom: 30px;
            }

            body {
                /* Layout & Box Model */
                min-height: 100vh;
            }
            
            .game-content {
                /* Layout & Box Model */
                min-height: 100vh;
                padding-top: 30px;
                padding-bottom: 50px;
            }
        }

        @media screen and (max-width: 768px) {

            #gameContent {
                /* Layout & Box Model */
                padding-top: 60px;
            }
            
            .menu-button {
                /* Positioning */
                z-index: 200;

                /* Visual */
                background-color: rgba(76, 175, 80, 0.9);
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            }
            
            body.dark-mode .menu-button {
                /* Visual */
                background-color: rgba(76, 175, 80, 0.9);
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            }
        }

    </style>

</head>  



















<body class="dark-mode">  

    <!-- ===== START MENU ===== -->

    <div id="startMenu" class="start-menu">
        <div class="start-content">
            <h1> Code Breaking Game </h1>
            <p> Test your code cracking skills with 10 challenging puzzles </p>
            <button id="startButton" onclick="startGame()"> Start Game </button>
        </div>
    </div>

    <!-- ===== END GAME SCREEN ===== -->

    <div id="endGameScreen" class="start-menu" style="display: none;">
        <div class="end-content">
            <h1> Code Breaking Game Completed! </h1>
            <div class="trophy"> 
                <img src="images/end-screen-medal.png" alt="Achievement Medal" class="medal-img" >
            </div>
            <p> You've successfully solved all 10 puzzles! </p>
            <div class="end-buttons">
                <button id="backToPuzzles" onclick="backToPuzzles()"> Back to Puzzles </button>
                <button id="endGameReset" onclick="resetProgressFromEndScreen()"> Play Again </button>
                <button id="showCredits" onclick="toggleCredits()"> Credits </button>
            </div>
            <div id="credits" class="credits">
                <p> Code Breaking Game </p>
                <p class="credit-role"> Game Design & Development </p>
                <p class="credit-name"> Sheer1_Clone </p>
                <p class="credit-role"> Medal Image </p>
                <p class="credit-name">
                    <a href="https://www.flaticon.com/free-icons/medal" title="medal icon" target="_blank" rel="noopener">
                        Created by setiawanap - Flaticon
                    </a>
                </p>
                <p class="credit-date"> © 2025 </p>
            </div>
        </div>
    </div>





    <!-- ===== MAIN GAME CONTENT ===== -->

    <div id="gameContent" class="game-content">
        <h1> Code Breaking Game </h1> 
    
        <!-- Menu Button and Menu -->
        <button class="menu-button" onclick="toggleMenu()"> Menu </button>
        <div class="menu" id="menu">
            <button onclick="toggleCheatSheet('morseCheatSheet')"> Morse Code </button>
            <button onclick="toggleCheatSheet('binaryCheatSheet')"> Binary Code </button>
            <button onclick="toggleCheatSheet('alphabetCheatSheet')"> Alphabet </button>
            <hr class="menu-separator">
            <button onclick="toggleDarkMode()" id="darkModeButton"> Light Mode </button>
            <hr class="menu-separator">
            <button onclick="resetProgress()"> Reset Progress </button>
        </div>
    
        <!-- Progress Tracker -->
        <div class="progress">
            Puzzle: <span id="currentPuzzle"> 1 </span>/10 | Solved: <span id="solvedCount"> 0 </span>
        </div>
        
        <!-- Message and Effects Containers -->
        <div class="fireworks-container" id="fireworksContainer"></div>
        <div class="success-message" id="successMessage"> Great job! Puzzle solved! </div>  
        <div class="error-message" id="errorMessage"> Incorrect answer. Try again! </div>
        




        <!-- ===== PUZZLES ===== -->

        <div class="puzzle-container">  
            <!-- Puzzle 1: Anagram -->
            <div class="puzzle active" id="puzzle1">  
                <h2> Puzzle 1: Anagram </h2>  
                <p> Rearrange these letters to form a word: </p>  
                <p><strong> EARDM </strong></p>  
                <input type="text" id="answer1" placeholder="Enter your answer">  
                <button onclick="checkAnswer(1)"> Submit </button>  
                <div class="hint-block" onclick="showHint(1)"> Hint </div>
                <div class="hint" id="hint1"> Something you do at night. </div>  
            </div>  



            <!-- Puzzle 2: Caesar Cipher 1 -->
            <div class="puzzle" id="puzzle2">  
                <h2> Puzzle 2: Caesar Cipher </h2>  
                <p> Replace each letter with the next letter in the alphabet: </p>  
                <p><strong> GDKKN </strong></p>  
                <input type="text" id="answer2" placeholder="Enter your answer">  
                <button onclick="checkAnswer(2)"> Submit </button>  
                <div class="hint-block" onclick="showHint(2)"> Hint </div>
                <div class="hint" id="hint2"> A = B, B = C, etc. </div>  
            </div>  



            <!-- Puzzle 3: Numbers To Letters -->
            <div class="puzzle" id="puzzle3">  
                <h2> Puzzle 3: Numbers To Letters </h2>  
                <p> Convert these numbers to letters following their positions in the alphabet: </p>  
                <p><strong> 3 &nbsp; 15 &nbsp; 4 &nbsp; 5 </strong></p>  
                <input type="text" id="answer3" placeholder="Enter your answer">  
                <button onclick="checkAnswer(3)"> Submit </button>  
                <div class="hint-block" onclick="showHint(3)"> Hint </div>
                <div class="hint" id="hint3"> 1 = A, 2 = B, etc. </div>  
            </div>  



            <!-- Puzzle 4: Caesar Cipher 2 -->
            <div class="puzzle" id="puzzle4">  
                <h2> Puzzle 4: Caesar Cipher 2 </h2>  
                <p> Replace each letter with the letter that's 3 positions backwards in the alphabet: </p>  
                <p><strong> VLPSOH </strong></p>  
                <input type="text" id="answer4" placeholder="Enter your answer">  
                <button onclick="checkAnswer(4)"> Submit </button>  
                <div class="hint-block" onclick="showHint(4)"> Hint </div>
                <div class="hint" id="hint4"> A = X, B = Y, etc. </div>  
            </div>  



            <!-- Puzzle 5: Missing Letter -->
            <div class="puzzle" id="puzzle5">  
                <h2> Puzzle 5: Missing Letter </h2>  
                <p> What letter completes this sequence? </p>  
                <p><strong> A, E, I, M, ? </strong></p>  
                <input type="text" id="answer5" placeholder="Enter your answer">  
                <button onclick="checkAnswer(5)"> Submit </button>  
                <div class="hint-block" onclick="showHint(5)"> Hint </div>
                <div class="hint" id="hint5"> Count the positions in the alphabet. </div>  
            </div>  



            <!-- Puzzle 6: Caesar Cipher 3 -->
            <div class="puzzle" id="puzzle6">  
                <h2> Puzzle 6: Caesar Cipher 3 </h2>  
                <p> Replace each letter with the letter that's 5 positions backwards in the alphabet: </p>  
                <p><strong> IJHNUMJW </strong></p>  
                <input type="text" id="answer6" placeholder="Enter your answer">  
                <button onclick="checkAnswer(6)"> Submit </button>  
                <div class="hint-block" onclick="showHint(6)"> Hint </div>
                <div class="hint" id="hint6"> A = V, B = W, etc. </div>  
            </div>  



            <!-- Puzzle 7: Morse Code -->
            <div class="puzzle" id="puzzle7">  
                <h2> Puzzle 7: Morse Code </h2>  
                <p> Decode this Morse code: </p>  
                <p><strong> .-.. &nbsp; --- &nbsp; -.-. &nbsp; -.- &nbsp; . &nbsp; .-. </strong></p>  
                <input type="text" id="answer7" placeholder="Enter your answer">  
                <button onclick="checkAnswer(7)"> Submit </button>  
                <div class="hint-block" onclick="showHint(7)"> Hint </div>
                <div class="hint" id="hint7"> Each letter is made of both dots (.) and dashes (-). </div>  
            </div>  



            <!-- Puzzle 8: Word Math -->
            <div class="puzzle" id="puzzle8">  
                <h2> Puzzle 8: Word Math </h2>  
                <p> What does CHERRY equal? </p>  
                <p><strong> APPLE = 50, BANANA = 33, CHERRY = ? </strong></p>  
                <input type="text" id="answer8" placeholder="Enter your answer">  
                <button onclick="checkAnswer(8)"> Submit </button>  
                <div class="hint-block" onclick="showHint(8)"> Hint </div>
                <div class="hint" id="hint8"> Each letter has a value based on its position in the alphabet. </div>  
            </div>  



            <!-- Puzzle 9: Binary to Text -->
            <div class="puzzle" id="puzzle9">  
                <h2> Puzzle 9: Binary to Text </h2>  
                <p> Convert this binary code to text: </p>  
                <p><strong> 01110000 &nbsp; 01110101 &nbsp; 01111010 &nbsp; 01111010 &nbsp; 01101100 &nbsp; 01100101 </strong></p>  
                <input type="text" id="answer9" placeholder="Enter your answer">  
                <button onclick="checkAnswer(9)"> Submit </button>  
                <div class="hint-block" onclick="showHint(9)"> Hint </div>
                <div class="hint" id="hint9"> Each 8-bit binary sequence represents a letter. </div>  
            </div>  



            <!-- Puzzle 10: Reverse Alphabet -->
            <div class="puzzle" id="puzzle10">  
                <h2> Puzzle 10: Reverse Alphabet </h2>  
                <p> Substitute each letter with its opposite in the reverse alphabet: </p>  
                <p><strong> HVXIVG </strong></p>  
                <input type="text" id="answer10" placeholder="Enter your answer">  
                <button onclick="checkAnswer(10)"> Submit </button>  
                <div class="hint-block" onclick="showHint(10)"> Hint </div>
                <div class="hint" id="hint10"> A = Z, B = Y, etc. </div>
            </div>
        </div>        





        <!-- ===== NAVIGATION ===== -->

        <div class="navigation-buttons"> 
            <button id="prevButton" onclick="navigatePuzzle(-1)"> Back </button>  
            <button id="nextButton" onclick="navigatePuzzle(1)"> Next </button>  
        </div>  
    </div>
    




    <!-- ===== REFERENCE SHEETS ===== -->

    <!-- Morse Code Reference -->
    <div id="morseCheatSheet" class="cheat-sheet">
        <div class="cheat-sheet-content">
            <span class="close-button" onclick="toggleCheatSheet('morseCheatSheet')"> &times; </span>
            <h2> Morse Code </h2>
            <div class="morse-grid">
                <div class="morse-item"><strong> A </strong><span class="morse-arrow"> = </span><span class="morse-code"> .-   </span></div>
                <div class="morse-item"><strong> B </strong><span class="morse-arrow"> = </span><span class="morse-code"> -... </span></div>
                <div class="morse-item"><strong> C </strong><span class="morse-arrow"> = </span><span class="morse-code"> -.-. </span></div>
                <div class="morse-item"><strong> D </strong><span class="morse-arrow"> = </span><span class="morse-code"> -..  </span></div>
                <div class="morse-item"><strong> E </strong><span class="morse-arrow"> = </span><span class="morse-code"> .    </span></div>
                <div class="morse-item"><strong> F </strong><span class="morse-arrow"> = </span><span class="morse-code"> ..-. </span></div>
                <div class="morse-item"><strong> G </strong><span class="morse-arrow"> = </span><span class="morse-code"> --.  </span></div>
                <div class="morse-item"><strong> H </strong><span class="morse-arrow"> = </span><span class="morse-code"> .... </span></div>
                <div class="morse-item"><strong> I </strong><span class="morse-arrow"> = </span><span class="morse-code"> ..   </span></div>
                <div class="morse-item"><strong> J </strong><span class="morse-arrow"> = </span><span class="morse-code"> .--- </span></div>
                <div class="morse-item"><strong> K </strong><span class="morse-arrow"> = </span><span class="morse-code"> -.-  </span></div>
                <div class="morse-item"><strong> L </strong><span class="morse-arrow"> = </span><span class="morse-code"> .-.. </span></div>
                <div class="morse-item"><strong> M </strong><span class="morse-arrow"> = </span><span class="morse-code"> --   </span></div>
                <div class="morse-item"><strong> N </strong><span class="morse-arrow"> = </span><span class="morse-code"> -.   </span></div>
                <div class="morse-item"><strong> O </strong><span class="morse-arrow"> = </span><span class="morse-code"> ---  </span></div>
                <div class="morse-item"><strong> P </strong><span class="morse-arrow"> = </span><span class="morse-code"> .--. </span></div>
                <div class="morse-item"><strong> Q </strong><span class="morse-arrow"> = </span><span class="morse-code"> --.- </span></div>
                <div class="morse-item"><strong> R </strong><span class="morse-arrow"> = </span><span class="morse-code"> .-.  </span></div>
                <div class="morse-item"><strong> S </strong><span class="morse-arrow"> = </span><span class="morse-code"> ...  </span></div>
                <div class="morse-item"><strong> T </strong><span class="morse-arrow"> = </span><span class="morse-code"> -    </span></div>
                <div class="morse-item"><strong> U </strong><span class="morse-arrow"> = </span><span class="morse-code"> ..-  </span></div>
                <div class="morse-item"><strong> V </strong><span class="morse-arrow"> = </span><span class="morse-code"> ...- </span></div>
                <div class="morse-item"><strong> W </strong><span class="morse-arrow"> = </span><span class="morse-code"> .--  </span></div>
                <div class="morse-item"><strong> X </strong><span class="morse-arrow"> = </span><span class="morse-code"> -..- </span></div>
                <div class="morse-item"><strong> Y </strong><span class="morse-arrow"> = </span><span class="morse-code"> -.-- </span></div>
                <div class="morse-item"><strong> Z </strong><span class="morse-arrow"> = </span><span class="morse-code"> --.. </span></div>
            </div>
        </div>
    </div>

    <!-- Binary Code Reference -->
    <div id="binaryCheatSheet" class="cheat-sheet">
        <div class="cheat-sheet-content">
            <span class="close-button" onclick="toggleCheatSheet('binaryCheatSheet')"> &times; </span>
            <div class="info-container">
                <button class="info-button" onclick="toggleBinaryInfo(event)"> ⓘ </button>
            </div>            
            <h2> Binary Code </h2>
            <div class="binary-grid">
                <div class="binary-item"><strong> A </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100001 </span></div>
                <div class="binary-item"><strong> B </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100010 </span></div>
                <div class="binary-item"><strong> C </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100011 </span></div>
                <div class="binary-item"><strong> D </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100100 </span></div>
                <div class="binary-item"><strong> E </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100101 </span></div>
                <div class="binary-item"><strong> F </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100110 </span></div>
                <div class="binary-item"><strong> G </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01100111 </span></div>
                <div class="binary-item"><strong> H </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101000 </span></div>
                <div class="binary-item"><strong> I </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101001 </span></div>
                <div class="binary-item"><strong> J </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101010 </span></div>
                <div class="binary-item"><strong> K </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101011 </span></div>
                <div class="binary-item"><strong> L </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101100 </span></div>
                <div class="binary-item"><strong> M </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101101 </span></div>
                <div class="binary-item"><strong> N </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101110 </span></div>
                <div class="binary-item"><strong> O </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01101111 </span></div>
                <div class="binary-item"><strong> P </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110000 </span></div>
                <div class="binary-item"><strong> Q </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110001 </span></div>
                <div class="binary-item"><strong> R </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110010 </span></div>
                <div class="binary-item"><strong> S </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110011 </span></div>
                <div class="binary-item"><strong> T </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110100 </span></div>
                <div class="binary-item"><strong> U </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110101 </span></div>
                <div class="binary-item"><strong> V </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110110 </span></div>
                <div class="binary-item"><strong> W </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01110111 </span></div>
                <div class="binary-item"><strong> X </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01111000 </span></div>
                <div class="binary-item"><strong> Y </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01111001 </span></div>
                <div class="binary-item"><strong> Z </strong><span class="binary-arrow"> = </span><span class="binary-code"> 01111010 </span></div>
            </div>
        </div>
    </div>

    <!-- Alphabet Reference -->
    <div id="alphabetCheatSheet" class="cheat-sheet">
        <div class="cheat-sheet-content">
            <span class="close-button" onclick="toggleCheatSheet('alphabetCheatSheet')"> &times; </span>
            <h2> Alphabet Numbers </h2>
            <div class="alphabet-grid">
                <div class="alphabet-item"><strong> A </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 1 </span></div>
                <div class="alphabet-item"><strong> B </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 2 </span></div>
                <div class="alphabet-item"><strong> C </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 3 </span></div>
                <div class="alphabet-item"><strong> D </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 4 </span></div>
                <div class="alphabet-item"><strong> E </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 5 </span></div>
                <div class="alphabet-item"><strong> F </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 6 </span></div>
                <div class="alphabet-item"><strong> G </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 7 </span></div>
                <div class="alphabet-item"><strong> H </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 8 </span></div>
                <div class="alphabet-item"><strong> I </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 9 </span></div>
                <div class="alphabet-item"><strong> J </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 10 </span></div>
                <div class="alphabet-item"><strong> K </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 11 </span></div>
                <div class="alphabet-item"><strong> L </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 12 </span></div>
                <div class="alphabet-item"><strong> M </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 13 </span></div>
                <div class="alphabet-item"><strong> N </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 14 </span></div>
                <div class="alphabet-item"><strong> O </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 15 </span></div>
                <div class="alphabet-item"><strong> P </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 16 </span></div>
                <div class="alphabet-item"><strong> Q </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 17 </span></div>
                <div class="alphabet-item"><strong> R </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 18 </span></div>
                <div class="alphabet-item"><strong> S </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 19 </span></div>
                <div class="alphabet-item"><strong> T </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 20 </span></div>
                <div class="alphabet-item"><strong> U </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 21 </span></div>
                <div class="alphabet-item"><strong> V </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 22 </span></div>
                <div class="alphabet-item"><strong> W </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 23 </span></div>
                <div class="alphabet-item"><strong> X </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 24 </span></div>
                <div class="alphabet-item"><strong> Y </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 25 </span></div>
                <div class="alphabet-item"><strong> Z </strong><span class="alphabet-arrow"> = </span><span class="alphabet-code"> 26 </span></div>
            </div>
        </div>
    </div>





    <!-- ===== TOOLTIPS & DIALOGS ===== -->

    <!-- Binary information tooltip that explains ASCII values -->
    <div id="standalone-binary-tooltip" class="standalone-tooltip">
        For advanced users: The cheat sheet shows uppercase letters for simplicity, 
        but the binary values listed correspond to lowercase ASCII letters 
        (ranging from 97 to 122). The game will accept answers in either 
        uppercase or lowercase form.
    </div>
    
    <!-- Confirmation dialog for Play Again Button -->
    <div id="confirmationDialog" class="cheat-sheet">
        <div class="cheat-sheet-content confirmation-content">
            <h2> Play Again? </h2>
            <p> Starting a new game will reset all your progress. </p>
            <div class="confirmation-buttons">
                <button id="confirmReset" class="confirm-button"> Start New Game </button>
                <button id="cancelReset" class="cancel-button"> Cancel </button>
            </div>
        </div>
    </div>

    <!-- Confirmation dialog for Reset Progress Button -->
    <div id="resetConfirmationDialog" class="cheat-sheet">
        <div class="cheat-sheet-content confirmation-content">
            <h2> Reset Progress? </h2>
            <p> This will clear all your solved puzzles. </p>
            <div class="confirmation-buttons">
                <button id="confirmResetProgress" class="confirm-button"> Reset Progress </button>
                <button id="cancelResetProgress" class="cancel-button"> Cancel </button>
            </div>
        </div>
    </div>
















    
    <script>

        /* ===== CONSTANTS & VARIABLES ===== */

        // Game state variables
        let currentPuzzle = 1;
        let solvedPuzzles = new Set();
        let navigationTimeout = null;
        
        // Puzzle answers
        const answers = {
            1: "DREAM",
            2: "HELLO",
            3: "CODE",
            4: "SIMPLE",
            5: "Q",
            6: "DECIPHER",
            7: "LOCKER",
            8: "77",
            9: "PUZZLE",
            10: "SECRET"
        };





        /* ===== CORE GAME FUNCTIONS ===== */

        /**
         * Checks the user's answer against the correct answer
         * @param {number} puzzleNumber - The puzzle number to check
         */
        function checkAnswer(puzzleNumber) {
            const userAnswer = document.getElementById(`answer${puzzleNumber}`).value.trim().toUpperCase();
            const correctAnswer = answers[puzzleNumber];
            const totalPuzzles = Object.keys(answers).length;
            const inputField = document.getElementById(`answer${puzzleNumber}`);
            
            // Always blur the input to dismiss mobile keyboard
            inputField.blur(); 

            if (userAnswer === correctAnswer) {
                // Handle solved puzzle tracking
                if (!solvedPuzzles.has(puzzleNumber)) {
                    solvedPuzzles.add(puzzleNumber);
                    document.getElementById("solvedCount").textContent = solvedPuzzles.size;

                    // Save solved puzzles to localStorage
                    saveSolvedPuzzles();
                }
                                
                // Determine which fireworks display to show
                if (solvedPuzzles.size === totalPuzzles) {
                    // Grand finale fireworks for completing all puzzles
                    createGrandFinaleFireworks();
                    
                    // Special final completion message
                    const successMessage = document.getElementById('successMessage');
                    successMessage.textContent = "Congratulations! You've completed all puzzles!";
                    successMessage.style.display = 'block';
                    
                        // Show end game screen after delay
                    setTimeout(() => {
                        successMessage.style.display = 'none';
                        successMessage.textContent = "Great job! Puzzle solved!";
                        showEndGameScreen();
                    }, 6000);
                } else {
                    // Regular fireworks and success message
                    createFireworks();
                    showSuccessMessage();
                    
                    // Auto-navigate to next puzzle after delay
                    if (navigationTimeout) {
                        clearTimeout(navigationTimeout);
                    }
                    
                    navigationTimeout = setTimeout(() => {
                        if (puzzleNumber < totalPuzzles) {
                            navigatePuzzle(1);
                        }
                        navigationTimeout = null;
                    }, 5000);
                }
            } else {
                // Handle incorrect answer
                showErrorMessage();
            }
        }



        /**
         * Update the UI to show solved status for a puzzle
         * @param {number} puzzleNumber - The puzzle number to update
         */
        function updateSolvedStatus(puzzleNumber) {
            const puzzle = document.getElementById(`puzzle${puzzleNumber}`);
            
            // Check if there's already a solved indicator
            let solvedIndicator = document.getElementById(`solved${puzzleNumber}`);
            
            // If puzzle is solved and we're returning to it
            if (solvedPuzzles.has(puzzleNumber)) {
                // Create indicator if it doesn't exist
                if (!solvedIndicator) {
                    solvedIndicator = document.createElement('span');
                    solvedIndicator.id = `solved${puzzleNumber}`;
                    solvedIndicator.className = 'solved-indicator';
                    solvedIndicator.textContent = 'Solved!';
                    
                    // Find the h2 element and append to it
                    const titleElement = puzzle.querySelector('h2');
                    if (titleElement) {
                        titleElement.appendChild(solvedIndicator);
                    }
                }
                
                // Show the indicator
                solvedIndicator.style.display = 'inline-block';
            } else if (solvedIndicator) {
                // Hide indicator if puzzle isn't solved
                solvedIndicator.style.display = 'none';
            }
        }
    




        /* ===== NAVIGATION FUNCTIONS ===== */

        /**
         * Navigate to the previous or next puzzle
         * @param {number} direction - Direction to navigate (-1 for prev, 1 for next)
         */
        function navigatePuzzle(direction) {
            // First, always clear any existing navigation timeout
            if (navigationTimeout) {
                clearTimeout(navigationTimeout);
                navigationTimeout = null;
            }
            
            const newPuzzleNum = currentPuzzle + direction;
            
            if (newPuzzleNum >= 1 && newPuzzleNum <= 10) {
                // Hide current puzzle
                document.querySelector(`#puzzle${currentPuzzle}`).classList.remove("active");
                // Update current puzzle
                currentPuzzle = newPuzzleNum;
                // Show new puzzle
                document.querySelector(`#puzzle${currentPuzzle}`).classList.add("active");
                // Update display number
                document.getElementById("currentPuzzle").textContent = currentPuzzle;
                
                saveCurrentPuzzle();

                // Reset all hints when navigating
                document.querySelectorAll('.hint').forEach(hint => {
                    hint.style.display = 'none';
                });
                document.querySelectorAll('.hint-block').forEach(hintBlock => {
                    hintBlock.style.display = 'block';
                });
                
                // Clear all input fields when navigating
                document.querySelectorAll('input[id^="answer"]').forEach(input => {
                    input.value = '';
                });
                
                // Show "Solved!" message if puzzle is already solved
                updateSolvedStatus(currentPuzzle);
            }
        }    





        /* ===== USER INTERFACE FUNCTIONS ===== */

        /**
         * Shows the success message for a short time
         */
        function showSuccessMessage() {
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 5000);
        }
        


        /**
         * Shows the error message for a short time
         */
        function showErrorMessage() {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.style.display = 'block';
            
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 1800);
        }
        


        /**
         * Toggles the menu visibility and ensures proper transparency
         */
        function toggleMenu() {
            const menu = document.getElementById('menu');
            const menuButton = document.querySelector('.menu-button');
            
            // Toggle menu visibility
            menu.classList.toggle('show');
            
            // Force reset of all button states
            menuButton.blur();
            
            // Apply correct transparency immediately and after a delay to catch all cases
            applyMenuButtonTransparency(menuButton);
            
            // Additional timeout to catch delayed rendering issues on mobile
            setTimeout(() => {
                applyMenuButtonTransparency(menuButton);
            }, 100);
        }



        /**
         * Applies the correct transparency to the menu button
         */
        function applyMenuButtonTransparency(button) {
            // Reset any inline styles
            button.style.backgroundColor = '';
            button.classList.remove('active');
            
            // Re-apply the semi-transparent background explicitly
            button.style.backgroundColor = 'rgba(76, 175, 80, 0.9)';
        }



        /**
         * Shows the hint for a specific puzzle
         * @param {number} puzzleNumber - The puzzle number to show hint for
         */
        function showHint(puzzleNumber) {
            document.getElementById(`hint${puzzleNumber}`).style.display = 'block';
            document.querySelector(`#puzzle${puzzleNumber} .hint-block`).style.display = 'none';
        }
           
        

        /**
         * Toggles dark mode and saves the preference
         */
        function toggleDarkMode() {
            const body = document.body;
            const darkModeButton = document.getElementById('darkModeButton');
            
            // Toggle dark mode class
            body.classList.toggle('dark-mode');
            
            // Save preference to localStorage
            const isDarkMode = body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
            
            // Update button text
            darkModeButton.textContent = isDarkMode ? 'Light Mode' : 'Dark Mode';
        }
    


        /**
         * Shows the reset progress confirmation dialog
         */
        function resetProgress() {
            // Show the new reset confirmation dialog
            document.getElementById('resetConfirmationDialog').style.display = 'block';
            
            // Set up event listeners for the buttons
            document.getElementById('confirmResetProgress').onclick = confirmResetProgress;
            document.getElementById('cancelResetProgress').onclick = cancelResetProgress;
        }



        /**
         * Handles reset progress confirmation
         */
        function confirmResetProgress() {
            // Hide the dialog
            document.getElementById('resetConfirmationDialog').style.display = 'none';
            
            // Reset progress
            localStorage.removeItem('solvedPuzzles');
            
            // Reset progress
            solvedPuzzles = new Set();
            document.getElementById("solvedCount").textContent = "0";
            
            // Clear all solved indicators
            document.querySelectorAll('.solved-indicator').forEach(indicator => {
                indicator.style.display = 'none';
            });
            
            // Navigate back to puzzle 1
            document.querySelector(`#puzzle${currentPuzzle}`).classList.remove("active");
            currentPuzzle = 1;
            document.querySelector(`#puzzle${currentPuzzle}`).classList.add("active");
            document.getElementById("currentPuzzle").textContent = "1";
            
            // Save the current puzzle
            localStorage.removeItem('currentPuzzle');
        }



        /**
         * Handles reset progress cancellation
         */
        function cancelResetProgress() {
            // Just hide the dialog
            document.getElementById('resetConfirmationDialog').style.display = 'none';
        }



        /**
         * Handles reset confirmation
         */
        function confirmReset() {
            // Hide the dialog
            document.getElementById('confirmationDialog').style.display = 'none';
            
            // Reset progress
            localStorage.removeItem('solvedPuzzles');
            localStorage.removeItem('currentPuzzle');
            
            // Navigate back to puzzle 1
            document.querySelector(`#puzzle${currentPuzzle}`).classList.remove("active");
            currentPuzzle = 1;
            document.querySelector(`#puzzle${currentPuzzle}`).classList.add("active");
            document.getElementById("currentPuzzle").textContent = currentPuzzle;
            
            solvedPuzzles = new Set();
            document.getElementById("solvedCount").textContent = "0";
            
            // Clear all solved indicators
            document.querySelectorAll('.solved-indicator').forEach(indicator => {
                indicator.style.display = 'none';
            });
        }



        /**
         * Handles reset cancellation
         */
        function cancelReset() {
            // Just hide the dialog
            document.getElementById('confirmationDialog').style.display = 'none';
        }



        /**
         * Shows the end game screen when all puzzles are completed
         */
        function showEndGameScreen() {
            document.getElementById('gameContent').style.display = 'none';
            document.getElementById('endGameScreen').style.display = 'flex';
        }



        /**
         * Goes back to puzzles from the end game screen
         */
        function backToPuzzles() {
            document.getElementById('endGameScreen').style.display = 'none';
            document.getElementById('gameContent').style.display = 'block';
        }



        /**
         * Resets progress and starts the game fresh
         */
        function resetAndRestart() {
            // Reset progress
            localStorage.removeItem('solvedPuzzles');
            localStorage.removeItem('currentPuzzle');
            
            solvedPuzzles = new Set();
            currentPuzzle = 1;
            
            // Update UI elements
            document.getElementById("solvedCount").textContent = "0";
            document.getElementById("currentPuzzle").textContent = "1";
            
            // Reset puzzle display
            document.querySelectorAll('.puzzle').forEach(puzzle => {
                puzzle.classList.remove('active');
            });
            document.getElementById('puzzle1').classList.add('active');
            
            // Clear solved indicators
            document.querySelectorAll('.solved-indicator').forEach(indicator => {
                indicator.style.display = 'none';
            });
            
            // Hide end screen and show game content
            document.getElementById('endGameScreen').style.display = 'none';
            document.getElementById('gameContent').style.display = 'block';
        }



        /**
         * Shows reset progress dialog from the end game screen
         */
        function resetProgressFromEndScreen() {
            // Show the confirmation dialog
            document.getElementById('confirmationDialog').style.display = 'block';
            
            // Set up event listeners for the buttons
            document.getElementById('confirmReset').onclick = function() {
                document.getElementById('confirmationDialog').style.display = 'none';
                resetAndRestart();
            };
            document.getElementById('cancelReset').onclick = cancelReset;
        }



        /**
         * Toggles the credits section visibility
         */
        function toggleCredits() {
            const credits = document.getElementById('credits');
            credits.style.display = credits.style.display === 'block' ? 'none' : 'block';
        }



        /**
         * Starts the game by fading out the menu and showing game content
         */
        function startGame() {
            // Fade out start menu
            const startMenu = document.getElementById('startMenu');
            startMenu.style.opacity = 0;
            
            // Show game content (must happen before the timeout)
            const gameContent = document.getElementById('gameContent');
            gameContent.style.display = 'block';
            
            // Remove start menu after fade completes
            setTimeout(() => {
                startMenu.style.display = 'none';
            }, 500);
            
            // Save that game has been started this session
            sessionStorage.setItem('gameStarted', 'true');
        }
        


        // Store a reference to the current handler
        let currentTooltipHandler = null;



        /**
         * Toggles the binary information tooltip
         * @param {Event} event - The click event that triggered the tooltip
         */
        function toggleBinaryInfo(event) {
            if (!event) return; // Safety check
            
            const tooltip = document.getElementById('standalone-binary-tooltip');
            
            // First, remove any existing click handler
            if (currentTooltipHandler) {
                document.removeEventListener('click', currentTooltipHandler);
                currentTooltipHandler = null;
            }
            
            if (tooltip.style.display === 'block') {
                tooltip.style.display = 'none';
            } else {
                // Position it near the button but above the cheat sheet content
                const button = event.currentTarget;
                const rect = button.getBoundingClientRect();
                
                tooltip.style.display = 'block';
                tooltip.style.left = rect.left + 'px';
                tooltip.style.top = (rect.top - tooltip.offsetHeight - 30) + 'px';
                
                // Add event listener to close when clicking anywhere else
                currentTooltipHandler = function(e) {
                    if (e.target !== tooltip && e.target !== button) {
                        tooltip.style.display = 'none';
                        document.removeEventListener('click', currentTooltipHandler);
                        currentTooltipHandler = null;
                    }
                };
                
                setTimeout(() => {
                    document.addEventListener('click', currentTooltipHandler);
                }, 100);
            }
        }



        /**
         * Toggles the visibility of a cheat sheet
         * @param {string} cheatSheetId - The ID of the cheat sheet to toggle
         */
        function toggleCheatSheet(cheatSheetId) {
            const cheatSheet = document.getElementById(cheatSheetId);
            if (cheatSheet.style.display === 'block') {
                cheatSheet.style.display = 'none';
                
                // Also hide the tooltip when closing the cheat sheet
                document.getElementById('standalone-binary-tooltip').style.display = 'none';
            } else {
                cheatSheet.style.display = 'block';
            }
            
            // Close the menu when opening the cheat sheet
            document.getElementById('menu').classList.remove('show');
        }





        /* ===== PERSISTENCE FUNCTIONS ===== */

        /**
         * Saves the solved puzzles to localStorage
         */
        function saveSolvedPuzzles() {
            localStorage.setItem('solvedPuzzles', JSON.stringify([...solvedPuzzles]));
        }
        


        /**
         * Saves the current puzzle number to localStorage
         */
        function saveCurrentPuzzle() {
            localStorage.setItem('currentPuzzle', currentPuzzle);
        }
    




        /* ===== VISUAL EFFECTS FUNCTIONS ===== */

        /**
         * Creates fireworks animation for solving a puzzle
         */
        function createFireworks() {
            const container = document.getElementById('fireworksContainer');
            container.innerHTML = ''; // Clear previous fireworks
            
            // Create multiple fireworks
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    
                    // Random position around success message
                    const x = 50 + (Math.random() - 0.5) * 80;
                    const y = 50 + (Math.random() - 0.5) * 80;
                    
                    // Random color
                    const hue = Math.floor(Math.random() * 360);
                    firework.style.left = `${x}%`;
                    firework.style.top = `${y}%`;
                    firework.style.backgroundColor = `hsl(${hue}, 100%, 65%)`;
                    firework.style.boxShadow = `0 0 10px 5px hsla(${hue}, 100%, 65%, 0.8)`;
                    
                    container.appendChild(firework);
                    
                    // Remove firework after animation completes
                    setTimeout(() => {
                        if (firework.parentNode === container) {
                            container.removeChild(firework);
                        }
                    }, 5000);
                }, i * 90);
            }
        }
    


        /**
         * Creates an extravagant fireworks display for completing all puzzles
         */
        function createGrandFinaleFireworks() {
            const container = document.getElementById('fireworksContainer');
            container.innerHTML = ''; // Clear previous fireworks
            
            // Create a spectacular array of fireworks for the grand finale
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.className = 'firework';
                    
                    // Random position across entire screen
                    const x = Math.random() * 100; 
                    const y = Math.random() * 100;
                    
                    // Random color with emphasis on celebratory colors
                    const hue = Math.floor(Math.random() * 360);

                    firework.style.left = `${x}%`;
                    firework.style.top = `${y}%`;
                    
                    // Create three sizes of fireworks for visual variety
                    if (i % 20 === 0) {
                        // Super fireworks (5% chance)
                        firework.style.width = '12px';
                        firework.style.height = '12px';
                        firework.style.backgroundColor = `hsl(${hue}, 100%, 70%)`;
                        firework.style.boxShadow = `0 0 20px 12px hsla(${hue}, 100%, 70%, 0.9)`;
                    } else if (i % 3 === 0) {
                        // Large fireworks (33% chance)
                        firework.style.width = '8px';
                        firework.style.height = '8px';
                        firework.style.backgroundColor = `hsl(${hue}, 100%, 65%)`;
                        firework.style.boxShadow = `0 0 15px 8px hsla(${hue}, 100%, 65%, 0.8)`;
                    } else {
                        // Regular fireworks
                        firework.style.backgroundColor = `hsl(${hue}, 100%, 65%)`;
                        firework.style.boxShadow = `0 0 10px 5px hsla(${hue}, 100%, 65%, 0.8)`;
                    }
                    
                    container.appendChild(firework);
                    
                    // Longer animation time for super fireworks
                    const duration = i % 20 === 0 ? 5000 : 4500;
                    
                    // Remove firework after animation completes
                    setTimeout(() => {
                        if (firework.parentNode === container) {
                            container.removeChild(firework);
                        }
                    }, duration);
                }, i * 55);
            }
        }
    


    

        /* ===== EVENT LISTENERS ===== */

        // Add event listener for Enter key on answer inputs
        document.querySelectorAll('input[id^="answer"]').forEach(input => {
            input.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    const puzzleNumber = parseInt(this.id.replace('answer', ''));
                    checkAnswer(puzzleNumber);
                    this.blur(); // Force blur regardless of answer correctness
                }
            });
        });
    


        // Add click event listeners for cheat sheets
        document.querySelectorAll('.cheat-sheet').forEach(sheet => {
            sheet.addEventListener('click', function(event) {
                // If the click is directly on the overlay (not on the content)
                if (event.target === this) {
                    this.style.display = 'none';
                }
            });
        });
    


        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('menu');
            const menuButton = document.querySelector('.menu-button');
            
            // Close menu if clicking outside and menu is open
            if (menu.classList.contains('show') && 
                !menu.contains(event.target) && 
                !menuButton.contains(event.target)) {
                menu.classList.remove('show');
            }
        });
    


        // Close menus and cheat sheets when pressing Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                // Close both confirmation dialogs if open
                const confirmationDialog = document.getElementById('confirmationDialog');
                const resetConfirmationDialog = document.getElementById('resetConfirmationDialog');
                
                if (confirmationDialog && confirmationDialog.style.display === 'block') {
                    confirmationDialog.style.display = 'none';
                }
                
                if (resetConfirmationDialog && resetConfirmationDialog.style.display === 'block') {
                    resetConfirmationDialog.style.display = 'none';
                }
                
                // Close the menu if open
                const menu = document.getElementById('menu');
                if (menu.classList.contains('show')) {
                    menu.classList.remove('show');
                }
                
                // Close all open cheat sheets
                document.querySelectorAll('.cheat-sheet').forEach(sheet => {
                    if (sheet.style.display === 'block') {
                        sheet.style.display = 'none';
                    }
                });
            }
        });



        // Focus on current puzzle answer input when Tab pressed
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Tab' && document.activeElement.tagName !== 'INPUT') {
                event.preventDefault();
                document.getElementById(`answer${currentPuzzle}`).focus();
            }
        });



        // Handle browser back button
        window.addEventListener('popstate', function() {
            // Short delay to ensure DOM is updated
            setTimeout(() => {
                if (window.innerWidth <= 768) {
                    // Force a refresh of the viewport position
                    window.scrollBy(0, 1);
                    setTimeout(() => window.scrollBy(0, -1), 10);
                }
            }, 100);
        });



        document.addEventListener('visibilitychange', function() {
            // Do nothing - completely disable automatic scrolling when tab becomes visible
            // This prevents unwanted scrolling when returning to the tab
        });





        /* ===== INITIALIZATION ===== */

        document.addEventListener('DOMContentLoaded', function() {
            // Set initial puzzle counter
            document.getElementById("currentPuzzle").textContent = currentPuzzle;
            
            // Check if game was previously started
            const sessionStarted = sessionStorage.getItem('gameStarted');
            if (sessionStarted === 'true') {
                startGame();
            }
            
            // Set dark mode as default unless explicitly set to false
            const savedDarkMode = localStorage.getItem('darkMode');
            const darkModeButton = document.getElementById('darkModeButton');
            
            if (savedDarkMode === 'false') {
                // Only remove dark mode if explicitly set to false
                document.body.classList.remove('dark-mode');
                darkModeButton.textContent = 'Dark Mode';
            } else {
                // For first visits or if set to true, ensure dark mode is on
                document.body.classList.add('dark-mode');
                darkModeButton.textContent = 'Light Mode';
                // Set the preference to true for future visits
                localStorage.setItem('darkMode', 'true');
            }
    
            // Load solved puzzles from localStorage
            const savedPuzzles = localStorage.getItem('solvedPuzzles');
            if (savedPuzzles) {
                // Convert back from JSON to Set
                solvedPuzzles = new Set(JSON.parse(savedPuzzles));
                
                // Update counter in UI
                document.getElementById("solvedCount").textContent = solvedPuzzles.size;
                
                // Update UI for each solved puzzle
                solvedPuzzles.forEach(puzzleNumber => {
                    updateSolvedStatus(puzzleNumber);
                });
            }
            
            // Load and restore current puzzle from localStorage
            const savedCurrentPuzzle = localStorage.getItem('currentPuzzle');
            if (savedCurrentPuzzle) {
                // Remove active class from current puzzle
                document.querySelector(`#puzzle${currentPuzzle}`).classList.remove("active");
                
                // Set current puzzle to saved value
                currentPuzzle = parseInt(savedCurrentPuzzle);
                
                // Update UI
                document.querySelector(`#puzzle${currentPuzzle}`).classList.add("active");
                document.getElementById("currentPuzzle").textContent = currentPuzzle;
                
                // Show "Solved!" message if puzzle is already solved
                updateSolvedStatus(currentPuzzle);
            }

            // Initialize new players with first puzzle
            if (!savedCurrentPuzzle) {
                document.querySelector(`#puzzle${currentPuzzle}`).classList.remove("active");
                currentPuzzle = 1;
                document.querySelector(`#puzzle${currentPuzzle}`).classList.add("active");
                document.getElementById("currentPuzzle").textContent = "1";
            }

            // Add aria labels for accessibility
            document.querySelectorAll('.puzzle').forEach(puzzle => {
                const puzzleId = puzzle.id.replace('puzzle', '');
                const puzzleTitle = puzzle.querySelector('h2').textContent.trim();
                const input = puzzle.querySelector(`input[id="answer${puzzleId}"]`);
                if (input) {
                    input.setAttribute('aria-label', `Answer for ${puzzleTitle}`);
                }
            });

        });

    </script>

    <!-- Version 1.0.0 -->

</body>
</html>
